; PlatformIO Project Configuration File
; Fichier de configuration PlatformIO pour ESP32-S3-DevKitC-1 N16R8
; Nom d'environnement : [env:esp32s3_n16r8] (plus descriptif que ESP32_Diagnostic)

[env:ESP32_Diagnostic]
platform      = espressif32@^6.0.0
board         = esp32-s3-devkitc-1
framework     = arduino
monitor_speed = 115200
upload_speed  = 921600

; -------------------------------------------------------------------
; Configuration Matérielle N16R8
; -------------------------------------------------------------------
board_build.flash_mode   = qio
board_build.flash_size   = 16MB
board_build.f_flash      = 80000000L
board_build.partitions   = huge_app.csv

; PSRAM spécifique (8MB, mode QIO_OPI)
board_build.arduino.memory_type = qio_opi
board_build.f_psram             = 80000000L
board_build.psram               = enabled

; -------------------------------------------------------------------
; Compilation & Flags
; -------------------------------------------------------------------
build_unflags =
    -std=gnu++* 
    -std=c++*

build_flags =
    ; C++17 pour le code source
    -std=gnu++17 

    ; PSRAM : les plus critiques
    -DCONFIG_SPIRAM_BOOT_INIT 
    -DCONFIG_SPIRAM_USE 
    -DCONFIG_SPIRAM_ALLOW_BSS_SEG_EXTERNAL_MEMORY 
    -DCONFIG_SPIRAM_ALLOW_STACK_EXTERNAL_MEMORY
    -DBOARD_HAS_PSRAM   ; Indique la présence de PSRAM pour Arduino core/libraries

    ; Native USB (CDC sur boot)
    -DARDUINO_USB_CDC_ON_BOOT=1 
    -DARDUINO_USB_MODE=1 

    ; Version du projet
    -D PROJECT_VERSION='"3.12.3"' 

; -------------------------------------------------------------------
; Dépendances
; -------------------------------------------------------------------
lib_deps =
    adafruit/Adafruit NeoPixel@1.12.0
    adafruit/DHT sensor library@1.4.6
    adafruit/Adafruit BusIO@1.17.4
    adafruit/Adafruit GFX Library@1.12.4
    adafruit/Adafruit ST7735 and ST7789 Library@1.11.0
    mikalhart/TinyGPSPlus@^1.1.0
    olikraus/U8g2@^2.36.15

; -------------------------------------------------------------------
; Répertoires de build
; -------------------------------------------------------------------
[platformio]
build_dir       = C:/pio_builds/ESP32_Diagnostic
build_cache_dir = C:/pio_builds/ESP32_Diagnostic
